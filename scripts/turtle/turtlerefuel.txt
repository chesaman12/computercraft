-- Function to find a bucket in the inventory
local function findBucket()
    for i = 1, 16 do
        local item = turtle.getItemDetail(i)
        if item and item.name == "minecraft:bucket" then
            return i
        end
    end
    return nil
end

-- Function to refuel using lava
local function refuelWithLava()
    local bucketSlot = findBucket()
    if not bucketSlot then
        print("No bucket found in inventory")
        return false
    end

    turtle.select(bucketSlot)
    
    -- Attempt to collect lava from the tank below
    if not turtle.placeDown() then
        print("Failed to use bucket on tank below")
        return false
    end

    local item = turtle.getItemDetail()
    if not item or item.name ~= "minecraft:lava_bucket" then
        print("Failed to collect lava")
        return false
    end

    if not turtle.refuel(1) then
        print("Failed to refuel with lava")
        return false
    end

    return true
end

-- Main refueling loop
local initialFuel = turtle.getFuelLevel()
print("Initial fuel level: " .. initialFuel)

while turtle.getFuelLevel() < 1000000 do
    if not refuelWithLava() then
        print("Refueling failed")
        break
    end
    print("Current fuel level: " .. turtle.getFuelLevel())
end

local finalFuel = turtle.getFuelLevel()
print("Final fuel level: " .. finalFuel)
print("Fuel added: " .. (finalFuel - initialFuel))